<!DOCTYPE html>
<html>
  <head>
    <title>Prologue Kelompok 4</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="stylesheet" href="assets/css/main.custom.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css"
      rel="stylesheet"
    />

    <style>
      /* Tambahan untuk memastikan modal terlihat di atas video background */
      #memberModal {
        z-index: 10000; /* Lebih tinggi dari z-index video */
      }
      .member-card {
        cursor: pointer; /* Menunjukkan elemen bisa diklik */
      }
    </style>
  </head>
  <body class="is-preload">
    <audio id="bg-music" src="assets/audio/newhorizomn.mp3" loop></audio>

    <button
      id="mute-btn"
      style="
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
        background: rgba(0, 0, 0, 0.5);
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
      "
    >
      ðŸ”ˆ
    </button>

    <video autoplay muted loop id="bg-video">
      <source src="assets/video/Ep032.mp4" type="video/mp4" />
    </video>

    <div id="header">
      <div class="top">
        <div id="logo">
          <span class="image avatar48"
            ><img src="assets/fanteses.jpg" alt=""
          /></span>
          <h1 id="title">Kelompok 4</h1>
          <p>Web Design</p>
        </div>
        <nav id="nav">
          <ul>
            <li>
              <a href="#top" id="top-link"
                ><span class="icon solid fa-home">Intro</span></a
              >
            </li>
            <li>
              <a href="#members" id="portfolio-link"
                ><span class="icon solid fa-th">Members</span></a
              >
            </li>
            <li>
              <a href="#about" id="about-link"
                ><span class="icon solid fa-user">About Us</span></a
              >
            </li>
            <li>
              <a href="#contact" id="contact-link"
                ><span class="icon solid fa-envelope">Contact</span></a
              >
            </li>
          </ul>
        </nav>
      </div>
      <div class="bottom">
        <ul class="icons">
          <li>
            <a href="#" class="icon brands fa-twitter"
              ><span class="label">Twitter</span></a
            >
          </li>
          <li>
            <a href="#" class="icon brands fa-facebook-f"
              ><span class="label">Facebook</span></a
            >
          </li>
          <li>
            <a href="#" class="icon brands fa-github"
              ><span class="label">Github</span></a
            >
          </li>
          <li>
            <a href="#" class="icon brands fa-dribbble"
              ><span class="label">Dribbble</span></a
            >
          </li>
          <li>
            <a href="#" class="icon solid fa-envelope"
              ><span class="label">Email</span></a
            >
          </li>
        </ul>
      </div>
    </div>

    <div id="main">
      <section id="top" class="one dark cover">
        <div class="container">
          <header>
            <h2 class="alt">
              Welcome To<strong> WEB</strong>
              <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">Page!</a>
              ini<br />
              adalah Page yang di design dari
              <a href="http://html5up.net">HTML5 UP</a>.
            </h2>
            <p>
              Website ini di design ulang oleh<br />
              Kelompok 4
            </p>
          </header>
          <footer>
            <a href="#members" class="button scrolly">MEET OUR TEAM!</a>
          </footer>
        </div>
      </section>

      <section
        id="members"
        class="min-h-screen bg-white text-gray-900 px-8 py-20"
      >
        <h2 class="text-4xl font-bold text-center mb-16 text-gray-900">
          Members
        </h2>
        <div
          id="memberGrid"
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12 max-w-6xl mx-auto"
        ></div>
      </section>

      <section id="about" class="three">
        <div class="container">
          <header>
            <h2 class="text-white">About Us</h2>
          </header>
          <a href="#" class="image featured"
            ><img src="images/pic08.jpg" alt=""
          /></a>
          <p class="text-white">
            Kami adalah tim muda yang lahir dan tumbuh di era digitalâ€”generasi
            yang melek teknologi, kreatif, dan adaptif. Kami menggabungkan
            profesionalisme dengan cara kerja yang lebih fresh, fleksibel, dan
            penuh ide-ide baru.<br /><br />
            Setiap proyek kami kerjakan dengan totalitas, dari ngoding, desain,
            sampai editingâ€”semua dijalani dengan passion dan mindset
            kolaboratif. Kami percaya kerja nggak harus kaku, yang penting
            hasilnya rapi, cepat, dan impactful.<br /><br />
            Kalau kamu butuh tim yang serius tapi santai, kreatif tapi tetap
            on-trackâ€”kami hadir sebagai solusi yang kekinian dan bisa
            diandalkan.
          </p>
        </div>
      </section>

      <section id="contact" class="four">
        <div class="container">
          <header>
            <h2 class="text-white">Contact</h2>
          </header>
          <p class="text-4xl mb-4 text-white">
            Contact disini jika ada keperluan!
          </p>
          <form id="contactForm" method="post" action="#">
            <div class="row">
              <div class="mx-auto">
                <input
                  type="text"
                  name="name"
                  placeholder="Name"
                  class="text-sm py-2 px-3 w-full mb-4 rounded border border-gray-300"
                />
                <input
                  type="text"
                  name="email"
                  placeholder="Email"
                  class="text-sm py-2 px-3 w-full mb-4 rounded border border-gray-300"
                />
              </div>
              <div class="col-12">
                <textarea
                  name="message"
                  placeholder="Message"
                  class="mb-4 mx-auto max-w-md"
                ></textarea>
              </div>
              <div class="col-12">
                <input type="submit" value="Send Message" />
              </div>
            </div>
          </form>
        </div>
      </section>
    </div>

    <div id="footer">
      <ul class="copyright">
        <li class="text-white">Â© Untitled. All rights reserved.</li>
        <li class="text-white">
          Design: <a href="http://html5up.net" class="text-white">HTML5 UP</a>
        </li>
        <li class="text-white">
          <a href="login.html" class="text-white hover:underline"
            >Admin Login</a
          >
        </li>
      </ul>
    </div>

    <div
      id="memberModal"
      class="fixed inset-0 bg-gray-900 bg-opacity-75 overflow-y-auto h-full w-full flex items-center justify-center hidden"
    >
      <div
        class="bg-white p-6 md:p-8 rounded-lg shadow-xl w-11/12 md:w-full max-w-md mx-auto relative"
      >
        <button
          id="closeModalBtn"
          class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 text-3xl font-bold"
        >
          Ã—
        </button>
        <div class="text-center">
          <img
            id="modalMemberImage"
            src=""
            alt="Member Image"
            class="w-32 h-32 md:w-40 md:h-40 object-cover rounded-full mx-auto mb-4 border-4 border-gray-300"
          />
          <h2
            id="modalMemberName"
            class="text-2xl md:text-3xl font-bold text-gray-800 mb-2"
          ></h2>
          <p
            id="modalMemberQuote"
            class="text-md md:text-lg italic text-gray-600 mb-4 px-4"
          ></p>
        </div>
        <div class="border-t border-gray-200 pt-4">
          <h4 class="text-lg font-semibold text-gray-700 mb-2">Details:</h4>
          <p
            id="modalMemberDetails"
            class="text-gray-700 text-sm md:text-base"
          ></p>
        </div>
      </div>
    </div>

    <a
      href="login.html"
      id="hiddenAdminLoginBtn"
      style="
        display: none;
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #2d3748;
        color: white;
        padding: 10px 18px;
        border-radius: 8px;
        text-decoration: none;
        z-index: 10001;
        box-shadow: 0 4px 14px 0 rgba(0, 0, 0, 0.4);
        font-size: 14px;
      "
    >
      Zugang Admin
    </a>

    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // --- DATA & RENDER MEMBERS ---
        const defaultMembers = [
          {
            name: "Rifqy",
            quote: '"lah kirain pake ppt"',
            image: "assets/dawg-skull-emoji.gif",
            details:
              "Seorang yang penuh semangat dan selalu ingin tahu akan hal baru. Suka bereksperimen dengan teknologi terkini.",
          },
          {
            name: "Damar",
            quote: '"Throughout Heaven and Earth, I alone am honored"',
            image: "assets/jjk-freaky.gif",
            details:
              "Pemikir strategis dengan pandangan yang mendalam. Kutipan favoritnya mencerminkan kepercayaan dirinya.",
          },
          {
            name: "Alfian",
            quote: '"im the man in the box ðŸ¥€"',
            image: "assets/gus-gusfring.gif",
            details:
              "Dikenal dengan gayanya yang unik dan terkadang misterius. Selalu punya perspektif yang menarik.",
          },
          {
            name: "Dipa",
            quote: '"Ugh"',
            image: "assets/rigbycat-rigby.gif",
            details:
              "Singkat, padat, dan jelas. Pribadi yang efisien dan tidak suka bertele-tele, seperti kutipannya.",
          },
          {
            name: "Imron",
            quote: '"nothin."',
            image: "assets/wielino.png",
            details:
              "Tenang namun penuh dengan ide-ide brilian. Lebih suka tindakan nyata daripada banyak bicara.",
          },
          {
            name: "Abiem",
            quote: '"Yang Sudah Blh Pulang."',
            image: "assets/budi.png",
            details:
              "Efisien dan selalu to the point. Fokus pada penyelesaian tugas dengan cepat dan tepat.",
          },
        ];

        async function getMembersData() {
          try {
            const response = await fetch("/api/members");
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            const data = await response.json();
            localStorage.setItem("membersData", JSON.stringify(data));
            return data;
          } catch (err) {
            console.error("Gagal mengambil data dari server:", err);
            const fallback = localStorage.getItem("membersData");
            if (fallback) {
              console.log("Menggunakan data fallback dari localStorage.");
              return JSON.parse(fallback);
            }
            console.log("Menggunakan data default.");
            return defaultMembers;
          }
        }

        function renderMembersToDOM(membersToRender) {
          const memberGrid = document.getElementById("memberGrid");
          if (!memberGrid) return;
          memberGrid.innerHTML = "";
          membersToRender.forEach((member) => {
            const card = document.createElement("div");
            card.className =
              "member-card bg-gray-100 rounded-2xl overflow-hidden shadow-xl transform hover:scale-105 transition-transform duration-300";
            card.dataset.memberName = member.name;
            card.dataset.memberQuote = member.quote;
            card.dataset.memberImage = member.image;
            card.dataset.memberDetails = member.details;
            card.innerHTML = `
              <img src="${member.image}" alt="${member.name}" class="w-full h-40 object-cover">
              <div class="p-6">
                <h3 class="text-2xl font-bold mb-3">${member.name}</h3>
                <p class="text-gray-700 text-lg font-extrabold">${member.quote}</p>
              </div>`;
            memberGrid.appendChild(card);
          });
          setupModalListeners();
        }

        // --- MODAL LOGIC ---
        function setupModalListeners() {
          const memberCards = document.querySelectorAll(".member-card");
          const modal = document.getElementById("memberModal");
          const closeModalBtn = document.getElementById("closeModalBtn");
          const modalMemberName = document.getElementById("modalMemberName");
          const modalMemberImage = document.getElementById("modalMemberImage");
          const modalMemberQuote = document.getElementById("modalMemberQuote");
          const modalMemberDetails =
            document.getElementById("modalMemberDetails");

          if (!modal || !closeModalBtn) return;

          function closeModal() {
            modal.classList.add("hidden");
            document.body.style.overflow = "";
          }

          memberCards.forEach((card) => {
            card.addEventListener("click", () => {
              modalMemberName.textContent = card.dataset.memberName;
              modalMemberImage.src = card.dataset.memberImage;
              modalMemberQuote.textContent = card.dataset.memberQuote;
              modalMemberDetails.textContent = card.dataset.memberDetails;
              modal.classList.remove("hidden");
              document.body.style.overflow = "hidden";
            });
          });

          closeModalBtn.addEventListener("click", closeModal);
          modal.addEventListener(
            "click",
            (e) => e.target === modal && closeModal()
          );
          document.addEventListener(
            "keydown",
            (e) =>
              e.key === "Escape" &&
              !modal.classList.contains("hidden") &&
              closeModal()
          );
        }

        // --- BACKGROUND MUSIC & MUTE BUTTON (KODE BARU) ---
        const music = document.getElementById("bg-music");
        const muteBtn = document.getElementById("mute-btn");

        if (music && muteBtn) {
          // Atur volume ke level maksimal (1.0 = 100%)
          music.volume = 1.0;

          // Fungsi untuk mencoba memutar musik
          const playMusic = () => {
            const playPromise = music.play();

            if (playPromise !== undefined) {
              playPromise
                .then((_) => {
                  // Berhasil diputar secara otomatis
                  music.muted = false; // Pastikan musik tidak di-mute
                  muteBtn.textContent = "ðŸ”ˆ";
                })
                .catch((error) => {
                  // Gagal diputar otomatis, kita tunggu interaksi pengguna
                  console.log(
                    "Autoplay musik diblokir. Menunggu interaksi pengguna untuk memulai."
                  );
                  // Tambahkan event listener untuk klik pertama, setelah itu akan dihapus
                  document.body.addEventListener(
                    "click",
                    () => {
                      music.play();
                      music.muted = false;
                      muteBtn.textContent = "ðŸ”ˆ";
                    },
                    { once: true }
                  ); // Opsi 'once: true' membuat listener ini hanya berjalan sekali
                });
            }
          };

          // Coba putar musik saat halaman siap
          playMusic();

          // Logika untuk tombol mute/unmute tetap sama
          muteBtn.addEventListener("click", () => {
            music.muted = !music.muted;
            muteBtn.textContent = music.muted ? "ðŸ”‡" : "ðŸ”ˆ";
          });
        }

        // --- HIDDEN ADMIN BUTTON ---
        let keySequence = [];
        const adminCode = ["a", "d", "m", "i", "n"];
        document.addEventListener("keydown", (event) => {
          const key = event.key.toLowerCase();
          if (key.length === 1 && key >= "a" && key <= "z") {
            keySequence.push(key);
            keySequence = keySequence.slice(-adminCode.length);
            if (JSON.stringify(keySequence) === JSON.stringify(adminCode)) {
              document.getElementById("hiddenAdminLoginBtn").style.display =
                "inline-block";
              keySequence = [];
            }
          }
        });

        // --- CONTACT FORM FUNCTIONALITY ---
        const contactForm = document.getElementById("contactForm");
        if (contactForm) {
          contactForm.addEventListener("submit", async (event) => {
            event.preventDefault();

            const name = contactForm.querySelector('[name="name"]').value;
            const email = contactForm.querySelector('[name="email"]').value;
            const message = contactForm.querySelector('[name="message"]').value;

            // Validasi format email menggunakan Regex
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailPattern.test(email)) {
              alert(
                "Format email tidak valid. Harap gunakan format seperti 'email@domain.com'."
              );
              return;
            }

            if (!name || !email || !message) {
              alert("Harap isi semua kolom sebelum mengirim.");
              return;
            }

            try {
              const response = await fetch("/api/contact", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ name, email, message }),
              });

              const result = await response.json();
              alert(result.message);

              if (result.success) {
                contactForm.reset();
              }
            } catch (error) {
              console.error("Error submitting contact form:", error);
              alert("Gagal terhubung ke server. Silakan coba lagi.");
            }
          });
        }

        // --- INITIALIZE PAGE ---
        async function init() {
          const membersData = await getMembersData();
          renderMembersToDOM(membersData);
        }

        init();
      });
    </script>
  </body>
</html>
